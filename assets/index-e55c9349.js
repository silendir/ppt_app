var e=Object.defineProperty,n=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(n,t,o)=>t in n?e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,l=(e,n)=>{for(var t in n||(n={}))r.call(n,t)&&s(e,t,n[t]);if(o)for(var t of o(n))i.call(n,t)&&s(e,t,n[t]);return e},a=(e,o)=>n(e,t(o)),d=(e,n,t)=>new Promise(((o,r)=>{var i=e=>{try{l(t.next(e))}catch(n){r(n)}},s=e=>{try{l(t.throw(e))}catch(n){r(n)}},l=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,s);l((t=t.apply(e,n)).next())}));import{r as c,c as h,w as u,o as m,a as p,b as g,d as f,e as b,t as y,f as w,g as v,v as x,F as k,h as P,i as M,j as C,k as S,T,l as E,m as L,n as $,p as F,q as I,s as z,u as U,x as D}from"./vue-vendor-1ac24fe7.js";import{_ as A}from"./export-tools-14b6bab4.js";import"./marp-c30e3b3a.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&n(e)})).observe(document,{childList:!0,subtree:!0})}function n(e){if(e.ep)return;e.ep=!0;const n=function(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?n.credentials="include":"anonymous"===e.crossOrigin?n.credentials="omit":n.credentials="same-origin",n}(e);fetch(e.href,n)}}();const j=[{id:"default",name:"默认主题"},{id:"gaia",name:"Gaia"},{id:"uncover",name:"Uncover"},{id:"bespoke",name:"现代简约"},{id:"elegant",name:"优雅蓝"},{id:"corporate",name:"商务专业"},{id:"creative",name:"创意设计"},{id:"minimal",name:"极简黑白"}],_={bespoke:"\n/* @theme bespoke */\nsection {\n  background: #fafafa;\n  color: #333;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n  padding: 2rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\nh1 {\n  font-size: 2.5rem;\n  color: #2563eb;\n  margin-bottom: 1rem;\n}\n\nh2 {\n  font-size: 2rem;\n  color: #3b82f6;\n  margin-bottom: 0.8rem;\n}\n\nh3 {\n  font-size: 1.5rem;\n  color: #60a5fa;\n  margin-bottom: 0.6rem;\n}\n\nul, ol {\n  margin-left: 1.5rem;\n  line-height: 1.6;\n}\n\nli {\n  margin-bottom: 0.5rem;\n}\n\nstrong {\n  color: #1e40af;\n}\n\nsection::after {\n  content: attr(data-marpit-pagination) '/' attr(data-marpit-pagination-total);\n  font-size: 0.8rem;\n  color: #94a3b8;\n  position: absolute;\n  bottom: 1rem;\n  right: 1rem;\n}\n\nimg {\n  max-width: 100%;\n  height: auto;\n  border-radius: 4px;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n}\n\nblockquote {\n  border-left: 4px solid #3b82f6;\n  padding-left: 1rem;\n  color: #64748b;\n  font-style: italic;\n}\n\ntable {\n  border-collapse: collapse;\n  width: 100%;\n  margin: 1rem 0;\n}\n\nth, td {\n  border: 1px solid #e2e8f0;\n  padding: 0.5rem;\n  text-align: left;\n}\n\nth {\n  background-color: #f1f5f9;\n  font-weight: bold;\n}\n\ncode {\n  background-color: #f1f5f9;\n  padding: 0.2rem 0.4rem;\n  border-radius: 4px;\n  font-family: 'Courier New', Courier, monospace;\n}\n\nsection.title {\n  background: linear-gradient(135deg, #2563eb, #3b82f6);\n  color: white;\n  text-align: center;\n}\n\nsection.title h1 {\n  color: white;\n  font-size: 3rem;\n}\n\nsection.title h2 {\n  color: rgba(255, 255, 255, 0.9);\n  font-weight: normal;\n}\n",elegant:"\n/* @theme elegant */\nsection {\n  background: linear-gradient(to bottom right, #f8f9fa, #e9ecef);\n  color: #212529;\n  font-family: 'Georgia', serif;\n  padding: 2rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  border-top: 8px solid #4361ee;\n}\n\nh1 {\n  font-size: 2.5rem;\n  color: #1e40af;\n  margin-bottom: 1rem;\n  font-weight: normal;\n  letter-spacing: -0.5px;\n  border-bottom: 1px solid #dee2e6;\n  padding-bottom: 0.5rem;\n}\n\nh2 {\n  font-size: 2rem;\n  color: #3b82f6;\n  margin-bottom: 0.8rem;\n  font-weight: normal;\n}\n\nh3 {\n  font-size: 1.5rem;\n  color: #4f46e5;\n  margin-bottom: 0.6rem;\n  font-style: italic;\n}\n\nul, ol {\n  margin-left: 1.5rem;\n  line-height: 1.7;\n}\n\nli {\n  margin-bottom: 0.7rem;\n  position: relative;\n}\n\nli::marker {\n  color: #4361ee;\n}\n\nstrong {\n  color: #1e3a8a;\n  font-weight: 600;\n}\n\nem {\n  color: #4f46e5;\n  font-style: italic;\n}\n\nsection::after {\n  content: attr(data-marpit-pagination) '/' attr(data-marpit-pagination-total);\n  font-size: 0.9rem;\n  color: #6c757d;\n  position: absolute;\n  bottom: 1rem;\n  right: 1rem;\n  font-family: 'Georgia', serif;\n  font-style: italic;\n}\n\nimg {\n  max-width: 100%;\n  height: auto;\n  border-radius: 4px;\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\n  border: 1px solid #dee2e6;\n}\n\nblockquote {\n  border-left: 3px solid #4361ee;\n  padding: 0.5rem 0 0.5rem 1.5rem;\n  margin: 1.5rem 0;\n  color: #495057;\n  font-style: italic;\n  background-color: rgba(67, 97, 238, 0.05);\n}\n\ntable {\n  border-collapse: collapse;\n  width: 100%;\n  margin: 1.5rem 0;\n  border: 1px solid #dee2e6;\n}\n\nth, td {\n  border: 1px solid #dee2e6;\n  padding: 0.75rem;\n  text-align: left;\n}\n\nth {\n  background-color: #e9ecef;\n  color: #212529;\n  font-weight: bold;\n}\n\ntr:nth-child(even) {\n  background-color: #f8f9fa;\n}\n\ncode {\n  font-family: 'Consolas', monospace;\n  background-color: #f8f9fa;\n  padding: 0.2rem 0.4rem;\n  border-radius: 4px;\n  color: #e83e8c;\n  border: 1px solid #dee2e6;\n}\n\nsection.title {\n  background: linear-gradient(135deg, #1e3a8a, #4361ee);\n  color: white;\n  text-align: center;\n  border-top: none;\n}\n\nsection.title h1 {\n  color: white;\n  font-size: 3rem;\n  border-bottom: none;\n  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n}\n\nsection.title h2 {\n  color: rgba(255, 255, 255, 0.9);\n  font-weight: normal;\n}\n",corporate:"\n/* @theme corporate */\nsection {\n  background: white;\n  color: #333;\n  font-family: 'Arial', sans-serif;\n  padding: 2rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  border-left: 10px solid #0a66c2;\n}\n\nh1 {\n  font-size: 2.4rem;\n  color: #0a66c2;\n  margin-bottom: 1rem;\n  font-weight: bold;\n}\n\nh2 {\n  font-size: 1.8rem;\n  color: #0a66c2;\n  margin-bottom: 0.8rem;\n  font-weight: bold;\n}\n\nh3 {\n  font-size: 1.4rem;\n  color: #0a66c2;\n  margin-bottom: 0.6rem;\n  font-weight: bold;\n}\n\nul, ol {\n  margin-left: 1.5rem;\n  line-height: 1.6;\n}\n\nli {\n  margin-bottom: 0.5rem;\n  position: relative;\n}\n\nli::marker {\n  color: #0a66c2;\n}\n\nstrong {\n  color: #0a66c2;\n  font-weight: bold;\n}\n\nsection::after {\n  content: attr(data-marpit-pagination) '/' attr(data-marpit-pagination-total);\n  font-size: 0.8rem;\n  color: #666;\n  position: absolute;\n  bottom: 1rem;\n  right: 1rem;\n}\n\nimg {\n  max-width: 100%;\n  height: auto;\n  border: 1px solid #e0e0e0;\n}\n\nblockquote {\n  border-left: 4px solid #0a66c2;\n  padding-left: 1rem;\n  color: #666;\n  font-style: italic;\n}\n\ntable {\n  border-collapse: collapse;\n  width: 100%;\n  margin: 1rem 0;\n}\n\nth, td {\n  border: 1px solid #e0e0e0;\n  padding: 0.75rem;\n  text-align: left;\n}\n\nth {\n  background-color: #0a66c2;\n  color: white;\n  font-weight: bold;\n}\n\ntr:nth-child(even) {\n  background-color: #f5f5f5;\n}\n\ncode {\n  background-color: #f5f5f5;\n  padding: 0.2rem 0.4rem;\n  border-radius: 2px;\n  font-family: 'Courier New', Courier, monospace;\n  color: #0a66c2;\n}\n\nsection.title {\n  background: linear-gradient(to right, #0a66c2, #0077b6);\n  color: white;\n  text-align: center;\n  border-left: none;\n}\n\nsection.title h1 {\n  color: white;\n  font-size: 2.8rem;\n}\n\nsection.title h2 {\n  color: rgba(255, 255, 255, 0.9);\n  font-weight: normal;\n}\n\nsection.title::before {\n  content: '';\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  height: 5px;\n  background: linear-gradient(to right, #0a66c2, #0077b6);\n}\n",creative:"\n/* @theme creative */\nsection {\n  background: #fefefe;\n  color: #333;\n  font-family: 'Montserrat', sans-serif;\n  padding: 2.5rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  background-image:\n    radial-gradient(circle at 10% 20%, rgba(255, 107, 107, 0.05) 0%, transparent 20%),\n    radial-gradient(circle at 90% 80%, rgba(107, 107, 255, 0.05) 0%, transparent 20%);\n  border-radius: 10px;\n  overflow: hidden;\n}\n\nh1 {\n  font-size: 2.8rem;\n  color: #ff6b6b;\n  margin-bottom: 1.2rem;\n  font-weight: 700;\n  letter-spacing: -1px;\n  position: relative;\n}\n\nh1::after {\n  content: '';\n  position: absolute;\n  bottom: -10px;\n  left: 0;\n  width: 50px;\n  height: 4px;\n  background: #ff6b6b;\n  border-radius: 2px;\n}\n\nh2 {\n  font-size: 2.2rem;\n  color: #6b6bff;\n  margin-bottom: 1rem;\n  font-weight: 600;\n}\n\nh3 {\n  font-size: 1.6rem;\n  color: #6b6bff;\n  margin-bottom: 0.8rem;\n  font-weight: 600;\n}\n\nul, ol {\n  margin-left: 1.5rem;\n  line-height: 1.7;\n}\n\nli {\n  margin-bottom: 0.7rem;\n  position: relative;\n}\n\nli::marker {\n  color: #ff6b6b;\n}\n\nstrong {\n  color: #ff6b6b;\n  font-weight: 700;\n}\n\nem {\n  color: #6b6bff;\n  font-style: italic;\n}\n\nsection::after {\n  content: attr(data-marpit-pagination) '/' attr(data-marpit-pagination-total);\n  font-size: 0.9rem;\n  color: #888;\n  position: absolute;\n  bottom: 1rem;\n  right: 1rem;\n  font-family: 'Montserrat', sans-serif;\n  font-weight: 500;\n}\n\nimg {\n  max-width: 100%;\n  height: auto;\n  border-radius: 10px;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n}\n\nblockquote {\n  border-left: 4px solid #ff6b6b;\n  padding: 0.8rem 0 0.8rem 1.5rem;\n  margin: 1.5rem 0;\n  color: #666;\n  font-style: italic;\n  background-color: rgba(255, 107, 107, 0.05);\n  border-radius: 0 10px 10px 0;\n}\n\ntable {\n  border-collapse: collapse;\n  width: 100%;\n  margin: 1.5rem 0;\n  border-radius: 10px;\n  overflow: hidden;\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);\n}\n\nth, td {\n  padding: 1rem;\n  text-align: left;\n}\n\nth {\n  background-color: #ff6b6b;\n  color: white;\n  font-weight: 600;\n}\n\ntr:nth-child(even) {\n  background-color: #f9f9f9;\n}\n\ntr:hover {\n  background-color: #f5f5f5;\n}\n\ncode {\n  font-family: 'Fira Code', monospace;\n  background-color: #f5f5f5;\n  padding: 0.2rem 0.5rem;\n  border-radius: 5px;\n  color: #ff6b6b;\n  font-size: 0.9em;\n}\n\nsection.title {\n  background: linear-gradient(135deg, #ff6b6b, #6b6bff);\n  color: white;\n  text-align: center;\n}\n\nsection.title h1 {\n  color: white;\n  font-size: 3.5rem;\n  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n}\n\nsection.title h1::after {\n  background: white;\n  width: 100px;\n  left: 50%;\n  transform: translateX(-50%);\n}\n\nsection.title h2 {\n  color: rgba(255, 255, 255, 0.9);\n  font-weight: 400;\n}\n",minimal:"\n/* @theme minimal */\nsection {\n  background: white;\n  color: #222;\n  font-family: 'Helvetica Neue', Arial, sans-serif;\n  padding: 3rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\nh1 {\n  font-size: 2.5rem;\n  color: black;\n  margin-bottom: 1.5rem;\n  font-weight: 700;\n  letter-spacing: -0.5px;\n}\n\nh2 {\n  font-size: 2rem;\n  color: #333;\n  margin-bottom: 1.2rem;\n  font-weight: 600;\n}\n\nh3 {\n  font-size: 1.5rem;\n  color: #444;\n  margin-bottom: 1rem;\n  font-weight: 600;\n}\n\nul, ol {\n  margin-left: 1.5rem;\n  line-height: 1.6;\n}\n\nli {\n  margin-bottom: 0.8rem;\n}\n\nstrong {\n  font-weight: 700;\n}\n\nsection::after {\n  content: attr(data-marpit-pagination);\n  font-size: 0.8rem;\n  color: #999;\n  position: absolute;\n  bottom: 1rem;\n  right: 1rem;\n}\n\nimg {\n  max-width: 100%;\n  height: auto;\n  border: none;\n}\n\nblockquote {\n  border-left: 2px solid #ddd;\n  padding-left: 1rem;\n  color: #666;\n  font-style: italic;\n}\n\ntable {\n  border-collapse: collapse;\n  width: 100%;\n  margin: 1.5rem 0;\n}\n\nth, td {\n  border-bottom: 1px solid #eee;\n  padding: 0.75rem;\n  text-align: left;\n}\n\nth {\n  border-bottom: 2px solid #ddd;\n  font-weight: 700;\n}\n\ncode {\n  font-family: 'SF Mono', Menlo, Monaco, Consolas, monospace;\n  background-color: #f5f5f5;\n  padding: 0.2rem 0.4rem;\n  border-radius: 3px;\n  font-size: 0.9em;\n}\n\nsection.title {\n  background: black;\n  color: white;\n  text-align: center;\n}\n\nsection.title h1 {\n  color: white;\n  font-size: 3rem;\n}\n\nsection.title h2 {\n  color: rgba(255, 255, 255, 0.8);\n  font-weight: 400;\n}\n"};function q(e,n="default"){return e.startsWith("---\n")?(e.includes("marp: true")||(e=e.replace("---\n","---\nmarp: true\n")),(e=e.includes("theme:")?e.replace(/theme:.*\n/,`theme: ${n}\n`):e.replace("---\n",`---\ntheme: ${n}\n`)).includes("paginate:")||(e=e.replace("---\n","---\npaginate: true\n")),e):`---\nmarp: true\ntheme: ${n}\npaginate: true\n---\n\n${e}`}function O(e){return d(this,arguments,(function*(e,n="presentation.pdf",t="default",o={}){var r;try{const n=yield function(e,n="default"){return d(this,null,(function*(){try{const{Marp:t}=yield A((()=>import("./marp-c30e3b3a.js").then((e=>e.m))),[]),o=new t({inlineSVG:!0,html:!0,math:!0,minifyCSS:!1});Object.entries(_).forEach((([e,n])=>{o.themeSet.add(n)}));const r=q(e,n),{html:i,css:s,comments:l}=o.render(r);return{html:`\n<!DOCTYPE html>\n<html lang="zh-CN">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>jsPPT演示文稿</title>\n  <style>\n    /* 基础样式 */\n    body {\n      margin: 0;\n      padding: 0;\n      background-color: #f0f0f0;\n    }\n    .marp-container {\n      width: 100%;\n      height: 100%;\n      overflow: auto;\n    }\n    /* Marp主题样式 */\n    ${s}\n    /* 打印优化 */\n    @media print {\n      body {\n        background-color: white;\n      }\n      .marp-container {\n        width: 100%;\n        height: auto;\n      }\n    }\n  </style>\n  <script>\n    // 简单的幻灯片导航功能\n    document.addEventListener('DOMContentLoaded', () => {\n      const sections = document.querySelectorAll('section');\n      let currentSlide = 0;\n\n      function goToSlide(index) {\n        if (index >= 0 && index < sections.length) {\n          sections[currentSlide].style.display = 'none';\n          currentSlide = index;\n          sections[currentSlide].style.display = 'flex';\n        }\n      }\n\n      // 初始化显示第一张幻灯片\n      sections.forEach((section, index) => {\n        section.style.display = index === 0 ? 'flex' : 'none';\n      });\n\n      // 键盘导航\n      document.addEventListener('keydown', (e) => {\n        if (e.key === 'ArrowRight' || e.key === 'PageDown' || e.key === ' ') {\n          goToSlide(currentSlide + 1);\n        } else if (e.key === 'ArrowLeft' || e.key === 'PageUp') {\n          goToSlide(currentSlide - 1);\n        } else if (e.key === 'Home') {\n          goToSlide(0);\n        } else if (e.key === 'End') {\n          goToSlide(sections.length - 1);\n        }\n      });\n\n      // 添加触摸滑动支持\n      let touchStartX = 0;\n      document.addEventListener('touchstart', (e) => {\n        touchStartX = e.touches[0].clientX;\n      });\n      document.addEventListener('touchend', (e) => {\n        const touchEndX = e.changedTouches[0].clientX;\n        const diff = touchStartX - touchEndX;\n\n        if (Math.abs(diff) > 50) { // 最小滑动距离\n          if (diff > 0) {\n            // 向左滑动，下一张\n            goToSlide(currentSlide + 1);\n          } else {\n            // 向右滑动，上一张\n            goToSlide(currentSlide - 1);\n          }\n        }\n      });\n    });\n  <\/script>\n</head>\n<body>\n  <div class="marp-container">\n    ${i}\n  </div>\n</body>\n</html>\n    `,rawHtml:i,css:s,comments:l,slideCount:(i.match(/<section/g)||[]).length}}catch(t){throw t}}))}(e,t),{html:o,slideCount:i}=n,s=window.open("","_blank");if(!s)throw new Error("无法打开打印窗口，请检查浏览器是否阻止了弹出窗口");const l=document.createElement("div");l.innerHTML=o;const a=(null==(r=l.querySelector("style"))?void 0:r.innerHTML)||"",c="</html>",h="</body>",u="</div>",m=`\n      body { margin: 0; padding: 0; }\n      .print-container { width: 100%; }\n      section {\n        page-break-after: always;\n        height: 100vh;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        padding: 40px;\n        box-sizing: border-box;\n      }\n      section:last-child { page-break-after: auto; }\n      @media print {\n        body { background: white; }\n        section {\n          height: 100%;\n          page-break-inside: avoid;\n        }\n      }\n      ${a}\n    `,p="<script>"+"\n      // 自动打印\n      window.onload = function() {\n        setTimeout(function() {\n          window.print();\n        }, 500);\n      };\n    "+"<\/script>",g="<!DOCTYPE html>"+"<html>"+"<head>"+"<title>jsPPT演示文稿</title>"+"<style>"+m+"</style>"+"</head>"+"<body>"+'<div class="print-container">'+l.innerHTML+u+p+h+c;return s.document.write(g),s.document.close(),!0}catch(i){throw i}}))}function W(e,n="presentation.pptx",t="default"){return d(this,null,(function*(){try{const o=yield A((()=>import("./export-tools-14b6bab4.js").then((e=>e.p))),["assets/export-tools-14b6bab4.js","assets/marp-c30e3b3a.js"]),r=o.default||o,i=q(e,t).split("---").filter((e=>e.trim())),s=new r;s.defineLayout({name:"LAYOUT_16x9",width:10,height:5.625}),s.layout="LAYOUT_16x9";const l={default:{background:"FFFFFF",title:"333333",text:"666666",accent:"4361ee"},gaia:{background:"101010",title:"FFFFFF",text:"CCCCCC",accent:"3B82F6"},uncover:{background:"FFFFFF",title:"137CBD",text:"333333",accent:"137CBD"},bespoke:{background:"FAFAFA",title:"2563EB",text:"333333",accent:"3B82F6"},elegant:{background:"F8F9FA",title:"1E40AF",text:"212529",accent:"4361EE"},corporate:{background:"FFFFFF",title:"0A66C2",text:"333333",accent:"0A66C2"},creative:{background:"FEFEFE",title:"FF6B6B",text:"333333",accent:"6B6BFF"},minimal:{background:"FFFFFF",title:"000000",text:"222222",accent:"999999"}},a=l[t]||l.default;for(let e=0;e<i.length;e++){const n=i[e],t=s.addSlide();t.background={color:a.background};const o=n.match(/^#\s+(.+)$/m),r=o?o[1]:"",l=n.match(/^##\s+(.+)$/m),d=l?l[1]:"";let c=n;o&&(c=c.replace(o[0],"").trim()),l&&(c=c.replace(l[0],"").trim());const h=0===e&&r&&!c.trim();r&&t.addText(r,{x:.5,y:h?2.5:.5,w:"90%",fontSize:h?36:24,bold:!0,color:a.title,align:h?"center":"left"}),d&&t.addText(d,{x:.5,y:r?1.2:.5,w:"90%",fontSize:20,bold:!1,color:a.title,align:h?"center":"left"});const u=c.match(/(?:^\s*[-*+]\s+.+$(?:\n|$))+/gm)||[],m=c.match(/(?:^\s*\d+\.\s+.+$(?:\n|$))+/gm)||[];u.forEach((e=>{c=c.replace(e,"")})),m.forEach((e=>{c=c.replace(e,"")}));const p=c.match(/\|.+\|[\s\S]*?\|.+\|/g)||[];p.forEach((e=>{c=c.replace(e,"")}));const g=c.match(/!\[.*?\]\((.+?)\)/g)||[];g.forEach((e=>{c=c.replace(e,"")}));const f=c.trim();if(f){const e=f.replace(/\*\*(.+?)\*\*/g,"$1").replace(/\*(.+?)\*/g,"$1").replace(/`(.+?)`/g,"$1").replace(/\[(.+?)\]\(.+?\)/g,"$1");t.addText(e,{x:.5,y:r?d?2:1.5:.5,w:"90%",h:3,fontSize:14,color:a.text,bullet:!1})}u.forEach(((e,n)=>{const o=e.split("\n").filter((e=>e.trim())).map((e=>e.replace(/^\s*[-*+]\s+/,"").trim()));o.length>0&&t.addText(o,{x:.5,y:r?d?2:1.5:.5,w:"90%",h:3,fontSize:14,color:a.text,bullet:!0})})),m.forEach(((e,n)=>{const o=e.split("\n").filter((e=>e.trim())).map((e=>e.replace(/^\s*\d+\.\s+/,"").trim()));o.length>0&&t.addText(o,{x:.5,y:r?d?2:1.5:.5,w:"90%",h:3,fontSize:14,color:a.text,bullet:{type:"number"}})})),p.forEach(((e,n)=>{const o=e.split("\n").filter((e=>e.trim()&&e.includes("|"))).map((e=>e.split("|").filter((e=>""!==e)).map((e=>e.trim()))));if(o.length>1){const e=o[0],n=o.slice(2),i=[],s=[];for(let t=0;t<e.length;t++)s.push(8/e.length);i.push(e),n.forEach((e=>{i.push(e)})),t.addTable(i,{x:.5,y:r?d?2.5:2:1,w:9,color:a.text,fontSize:12,border:{pt:.5,color:a.accent}})}})),g.forEach(((e,n)=>{const o=e.match(/!\[.*?\]\((.+?)\)/);if(o&&o[1]){const e=o[1];t.addImage({path:e,x:.5,y:r?d?2.5:2:1,w:9,h:5})}})),h||t.addText(`${e+1} / ${i.length}`,{x:9,y:5.4,w:.5,fontSize:10,color:a.text,align:"right"})}return s.writeFile({fileName:n}),!0}catch(o){throw o}}))}function G(){return j}const B=(e,n)=>{const t=e.__vccOpts||e;for(const[o,r]of n)t[o]=r;return t},N={class:"preview-container"},H={class:"preview-header"},X={class:"preview-title"},R={key:0,class:"slide-count"},V={class:"preview-controls"},K={class:"theme-selector"},Y=["value"],Q={class:"export-buttons"},J={class:"preview-content"},Z={key:0,class:"loading-indicator"},ee=["innerHTML"],ne={class:"preview-footer"},te={class:"navigation-controls"},oe=["disabled"],re={class:"slide-indicator"},ie=["disabled"];const se=B({props:{markdown:{type:String,required:!0},initialTheme:{type:String,default:"default"}},emits:["close","theme-change","export"],setup(e,{emit:n}){const t=c(""),o=c(!0),r=c(0),i=c(0),s=c(e.initialTheme),l=c(G());c(null);const a=h((()=>{const e=l.value.find((e=>e.id===s.value));return e?e.name:"默认主题"})),g=()=>d(this,null,(function*(){try{o.value=!0;let i=e.markdown;i.startsWith("---\n")?i=i.includes("theme:")?i.replace(/theme:.*\n/,`theme: ${s.value}\n`):i.replace("---\n",`---\ntheme: ${s.value}\n`):i.startsWith("---\nmarp: true")||(i=`---\nmarp: true\ntheme: ${s.value}\npaginate: true\n---\n\n${i}`);try{const{Marp:e}=yield A((()=>import("./marp-c30e3b3a.js").then((e=>e.m))),[]),n=new e({inlineSVG:!0,html:!0,math:!0}),{html:o,css:s}=n.render(i),l=`\n            <style>${s}</style>\n            ${o}\n          `;t.value=l;const a=o.match(/<section/g);if(r.value=a?a.length:0,0===r.value){const e=i.split(/\n---\n/);r.value=e.length}}catch(n){const e=i.split(/\n---\n/);let o='<div class="marp-slides">';e.forEach(((e,n)=>{if(0===n&&e.startsWith("---")){const n=e.indexOf("---",3)+3;n>2&&(e=e.substring(n).trim())}let t=e.replace(/^# (.*?)$/gm,"<h1>$1</h1>").replace(/^## (.*?)$/gm,"<h2>$1</h2>").replace(/^### (.*?)$/gm,"<h3>$1</h3>").replace(/^- (.*?)$/gm,"<li>$1</li>").replace(/<\/li>\n<li>/g,"</li><li>").replace(new RegExp("(<li>.*?<\\/li>)","gs"),"<ul>$1</ul>").replace(/^([^<].*?)$/gm,"<p>$1</p>").replace(/<p><\/p>/g,"").replace(/!\[(.*?)\]\((.*?)\)/g,'<img alt="$1" src="$2" style="max-width: 100%;">').replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2">$1</a>');o+=`<section class="slide" id="slide-${n+1}">${t}</section>`})),o+="</div>",t.value=o,r.value=e.length}}catch(n){t.value=`<div class="error">渲染失败: ${n.message}</div>`,r.value=0}finally{o.value=!1}})),f=()=>{i.value>0&&(i.value--,y(i.value))},b=()=>{i.value<r.value-1&&(i.value++,y(i.value))},y=e=>{const n=document.querySelectorAll(".marp-preview section");n.length>0&&n[e]&&n[e].scrollIntoView({behavior:"smooth"})},w=e=>{"ArrowRight"===e.key||"PageDown"===e.key||" "===e.key?b():"ArrowLeft"===e.key||"PageUp"===e.key?f():"Home"===e.key?(i.value=0,y(0)):"End"===e.key&&(i.value=r.value-1,y(r.value-1))};return u((()=>e.markdown),(()=>{g()})),u((()=>e.initialTheme),(e=>{s.value=e,g()})),m((()=>{g(),window.addEventListener("keydown",w)})),p((()=>{window.removeEventListener("keydown",w)})),{renderedHTML:t,isLoading:o,slideCount:r,currentSlide:i,selectedTheme:s,availableThemes:l,currentThemeName:a,changeTheme:()=>{n("theme-change",s.value),g()},prevSlide:f,nextSlide:b,exportPDF:()=>d(this,null,(function*(){var e;try{n("export",{type:"pdf",theme:s.value});const o=document.createElement("div");o.style.position="fixed",o.style.top="50%",o.style.left="50%",o.style.transform="translate(-50%, -50%)",o.style.padding="20px",o.style.backgroundColor="rgba(0, 0, 0, 0.8)",o.style.color="white",o.style.borderRadius="8px",o.style.zIndex="10000",o.style.fontWeight="bold",o.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.2)",o.style.minWidth="250px",o.style.textAlign="center",o.textContent="正在准备打印预览...",document.body.appendChild(o);try{const n=document.querySelector(".marp-preview");if(!n)throw new Error("无法找到预览内容");const t=window.open("","_blank");if(!t)throw new Error("无法打开打印窗口，请检查浏览器是否阻止了弹出窗口");const r=(null==(e=n.querySelector("style"))?void 0:e.innerHTML)||"",i="</html>",s="</body>",l="</div>",a=`\n            body { margin: 0; padding: 0; }\n            .print-container { width: 100%; }\n            section {\n              page-break-after: always;\n              height: 100vh;\n              display: flex;\n              flex-direction: column;\n              justify-content: center;\n              padding: 40px;\n              box-sizing: border-box;\n            }\n            section:last-child { page-break-after: auto; }\n            @media print {\n              body { background: white; }\n              section {\n                height: 100%;\n                page-break-inside: avoid;\n              }\n            }\n            ${r}\n          `,d="<script>"+"\n            // 自动打印\n            window.onload = function() {\n              setTimeout(function() {\n                window.print();\n              }, 500);\n            };\n          "+"<\/script>",c="<!DOCTYPE html>"+"<html>"+"<head>"+"<title>jsPPT演示文稿</title>"+"<style>"+a+"</style>"+"</head>"+"<body>"+'<div class="print-container">'+n.innerHTML+l+d+s+i;t.document.write(c),t.document.close(),o.textContent="已打开打印预览，请使用浏览器的打印功能保存为PDF",o.style.backgroundColor="rgba(16, 185, 129, 0.8)",setTimeout((()=>{document.body.removeChild(o)}),3e3)}catch(t){o.textContent=`PDF导出失败: ${t.message}`,o.style.backgroundColor="rgba(220, 38, 38, 0.8)",setTimeout((()=>{document.body.removeChild(o)}),3e3)}}catch(t){alert(`PDF导出失败: ${t.message}`)}})),exportPPTX:()=>d(this,null,(function*(){try{n("export",{type:"pptx",theme:s.value});const o=document.createElement("div");o.style.position="fixed",o.style.top="50%",o.style.left="50%",o.style.transform="translate(-50%, -50%)",o.style.padding="20px",o.style.backgroundColor="rgba(0, 0, 0, 0.8)",o.style.color="white",o.style.borderRadius="8px",o.style.zIndex="10000",o.style.fontWeight="bold",o.textContent="正在导出PPTX，请稍候...",document.body.appendChild(o);try{yield W(e.markdown,"presentation.pptx",s.value),o.textContent="PPTX导出成功！",o.style.backgroundColor="rgba(16, 185, 129, 0.8)",setTimeout((()=>{document.body.removeChild(o)}),2e3)}catch(t){o.textContent=`PPTX导出失败: ${t.message}`,o.style.backgroundColor="rgba(220, 38, 38, 0.8)",setTimeout((()=>{document.body.removeChild(o)}),3e3)}}catch(t){alert(`PPTX导出失败: ${t.message}`)}}))}}},[["render",function(e,n,t,o,r,i){return g(),f("div",{class:"preview-overlay",onClick:n[7]||(n[7]=E((n=>e.$emit("close")),["self"]))},[b("div",N,[b("div",H,[b("div",X,[n[8]||(n[8]=b("h2",null,"演示文稿预览",-1)),o.slideCount>0?(g(),f("span",R,y(o.slideCount)+"张幻灯片",1)):w("",!0)]),b("div",V,[b("div",K,[n[9]||(n[9]=b("label",{for:"theme-select"},"主题：",-1)),v(b("select",{id:"theme-select","onUpdate:modelValue":n[0]||(n[0]=e=>o.selectedTheme=e),onChange:n[1]||(n[1]=(...e)=>o.changeTheme&&o.changeTheme(...e)),class:"theme-select"},[(g(!0),f(k,null,P(o.availableThemes,(e=>(g(),f("option",{key:e.id,value:e.id},y(e.name),9,Y)))),128))],544),[[x,o.selectedTheme]])]),b("div",Q,[b("button",{class:"btn btn-primary",onClick:n[2]||(n[2]=(...e)=>o.exportPDF&&o.exportPDF(...e)),title:"导出为PDF"},n[10]||(n[10]=[b("i",{class:"fas fa-file-pdf"},null,-1),M(" PDF ")])),b("button",{class:"btn btn-success",onClick:n[3]||(n[3]=(...e)=>o.exportPPTX&&o.exportPPTX(...e)),title:"导出为PPTX"},n[11]||(n[11]=[b("i",{class:"fas fa-file-powerpoint"},null,-1),M(" PPTX ")]))]),b("button",{class:"close-btn",onClick:n[4]||(n[4]=n=>e.$emit("close"))},"×")])]),b("div",J,[C(T,{name:"fade"},{default:S((()=>[o.isLoading?(g(),f("div",Z,n[12]||(n[12]=[b("div",{class:"spinner"},null,-1),b("p",null,"正在渲染...",-1)]))):(g(),f("div",{key:1,class:"marp-preview",innerHTML:o.renderedHTML},null,8,ee))])),_:1})]),b("div",ne,[b("div",te,[b("button",{class:"nav-btn prev-btn",onClick:n[5]||(n[5]=(...e)=>o.prevSlide&&o.prevSlide(...e)),disabled:o.currentSlide<=0},n[13]||(n[13]=[b("i",{class:"fas fa-chevron-left"},null,-1),M(" 上一页 ")]),8,oe),b("span",re,y(o.currentSlide+1)+" / "+y(o.slideCount),1),b("button",{class:"nav-btn next-btn",onClick:n[6]||(n[6]=(...e)=>o.nextSlide&&o.nextSlide(...e)),disabled:o.currentSlide>=o.slideCount-1},n[14]||(n[14]=[M(" 下一页 "),b("i",{class:"fas fa-chevron-right"},null,-1)]),8,ie)])])])])}],["__scopeId","data-v-54b4745a"]]);const le=new class{checkWebGPUSupport(){return d(this,null,(function*(){if(!navigator.gpu)return{supported:!1,reason:"WebGPU API不可用"};try{const e=yield navigator.gpu.requestAdapter();if(!e)return{supported:!1,reason:"无法获取WebGPU适配器"};const n=yield e.requestDevice();return n?{supported:!0,adapter:e,device:n}:{supported:!1,reason:"无法创建WebGPU设备"}}catch(e){return{supported:!1,reason:`WebGPU初始化失败: ${e.message}`}}}))}checkWebGLSupport(){try{const e=document.createElement("canvas"),n=e.getContext("webgl2")||e.getContext("webgl");return n?{supported:!0,version:n instanceof WebGL2RenderingContext?2:1,context:n}:{supported:!1,reason:"WebGL不可用"}}catch(e){return{supported:!1,reason:`WebGL检测失败: ${e.message}`}}}checkDevicePerformance(){const e=navigator.deviceMemory||4,n=navigator.hardwareConcurrency||4,t=e*n/4;return{memory:e,cores:n,performanceScore:t,performanceTier:t>=8?"high":t>=4?"medium":"low"}}getBrowserInfo(){const e=navigator.userAgent;let n="未知",t="";return e.indexOf("Chrome")>-1&&-1===e.indexOf("Edg")?(n="Chrome",t=e.match(/Chrome\/([0-9.]+)/)[1]):e.indexOf("Edg")>-1?(n="Edge",t=e.match(/Edg\/([0-9.]+)/)[1]):e.indexOf("Firefox")>-1?(n="Firefox",t=e.match(/Firefox\/([0-9.]+)/)[1]):e.indexOf("Safari")>-1&&(n="Safari",t=e.match(/Safari\/([0-9.]+)/)[1]),{name:n,version:t}}isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}getFullCompatibilityReport(){return d(this,null,(function*(){const e=yield this.checkWebGPUSupport(),n=this.checkWebGLSupport(),t=this.checkDevicePerformance(),o=this.getBrowserInfo(),r=this.isMobileDevice();let i="远程API",s="低";return e.supported?(i="WebGPU",s="最佳"):n.supported?(i="WebGL",s="良好"):"low"!==t.performanceTier&&(i="WASM CPU",s="中等"),{browser:o,isMobile:r,webgpu:e,webgl:n,performance:t,recommendedStrategy:i,expectedPerformance:s}}))}};const ae=new class{constructor(){this.dbName="jsPPT-ModelCache",this.storeName="models",this.db=null}initDB(){return d(this,null,(function*(){return this.db?this.db:new Promise(((e,n)=>{const t=indexedDB.open(this.dbName,1);t.onupgradeneeded=e=>{const n=e.target.result;n.objectStoreNames.contains(this.storeName)||n.createObjectStore(this.storeName)},t.onsuccess=n=>{this.db=n.target.result,e(this.db)},t.onerror=e=>{n(e.target.error)}}))}))}hasModel(e){return d(this,null,(function*(){try{return yield this.initDB(),new Promise((n=>{const t=this.db.transaction(this.storeName,"readonly").objectStore(this.storeName).get(e);t.onsuccess=()=>{n(!!t.result)},t.onerror=()=>{n(!1)}}))}catch(n){return!1}}))}saveModel(e,n){return d(this,null,(function*(){try{return yield this.initDB(),new Promise(((t,o)=>{const r=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).put(n,e);r.onsuccess=()=>{t(!0)},r.onerror=e=>{o(e.target.error)}}))}catch(t){return!1}}))}getModel(e){return d(this,null,(function*(){try{return yield this.initDB(),new Promise(((n,t)=>{const o=this.db.transaction(this.storeName,"readonly").objectStore(this.storeName).get(e);o.onsuccess=()=>{n(o.result)},o.onerror=e=>{t(e.target.error)}}))}catch(n){throw n}}))}deleteModel(e){return d(this,null,(function*(){try{return yield this.initDB(),new Promise(((n,t)=>{const o=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).delete(e);o.onsuccess=()=>{n(!0)},o.onerror=e=>{t(e.target.error)}}))}catch(n){return!1}}))}clearCache(){return d(this,null,(function*(){try{return yield this.initDB(),new Promise(((e,n)=>{const t=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).clear();t.onsuccess=()=>{e(!0)},t.onerror=e=>{n(e.target.error)}}))}catch(e){return!1}}))}};const de=new class{constructor(e={}){this.options=l({modelId:"qwen3-0.6b",modelUrl:"https://cdn.jsppt.com/models/qwen3-0.6b-q4.gguf",chunkSize:10485760},e),this.totalChunks=0,this.loadedChunks=0,this.totalSize=0,this.abortController=null,this.isLoading=!1,this.progress=0,this.error=null,this.metadataKey=`${this.options.modelId}_metadata`}determineOptimalChunkSize(){return d(this,null,(function*(){try{const e=this.options.modelUrl.split("/").slice(0,-1).join("/")+"/network-test",n=Date.now();yield fetch(e,{method:"HEAD",cache:"no-store",signal:AbortSignal.timeout(3e3)});const t=Date.now()-n;return t<100?20971520:t<500?10485760:5242880}catch(e){return this.options.chunkSize}}))}getModelMetadata(){return d(this,null,(function*(){try{return yield ae.getModel(this.metadataKey)}catch(e){return null}}))}saveModelMetadata(e){return d(this,null,(function*(){try{return yield ae.saveModel(this.metadataKey,e)}catch(n){return!1}}))}isModelFullyCached(){return d(this,null,(function*(){try{const e=yield this.getModelMetadata();if(!e||!e.totalChunks||0===e.totalChunks)return!1;for(let n=0;n<e.totalChunks;n++){const e=`${this.options.modelId}_chunk_${n}`;if(!(yield ae.hasModel(e)))return!1}return!0}catch(e){return!1}}))}getModelSize(){return d(this,null,(function*(){try{const e=yield this.getModelMetadata();if(e&&e.totalSize)return e.totalSize;const n=yield fetch(this.options.modelUrl,{method:"HEAD",cache:"no-store"});if(!n.ok)throw new Error(`获取模型大小失败: ${n.status} ${n.statusText}`);const t=parseInt(n.headers.get("content-length")||"0");if(0===t)throw new Error("无法获取模型大小");return t}catch(e){throw e}}))}downloadModelInChunks(){return d(this,arguments,(function*(e={}){if(this.isLoading)throw new Error("模型正在下载中");try{this.isLoading=!0,this.progress=0,this.error=null,this.abortController=new AbortController,this.totalSize=yield this.getModelSize();const t=yield this.determineOptimalChunkSize();this.totalChunks=Math.ceil(this.totalSize/t),this.loadedChunks=0,yield this.saveModelMetadata({modelId:this.options.modelId,modelUrl:this.options.modelUrl,totalSize:this.totalSize,totalChunks:this.totalChunks,chunkSize:t,timestamp:Date.now()});const o=new ArrayBuffer(this.totalSize),r=new Uint8Array(o),i=[];for(let n=0;n<this.totalChunks;n++){const o=`${this.options.modelId}_chunk_${n}`,s=n*t,l=Math.min(s+t-1,this.totalSize-1);if(yield ae.hasModel(o)){const n=yield ae.getModel(o);r.set(new Uint8Array(n),s),this.loadedChunks++,this.progress=this.loadedChunks/this.totalChunks,e.onProgress&&e.onProgress(this.progress)}else i.push({chunkId:o,start:s,end:l})}if(0===i.length)return e.onComplete&&e.onComplete(o),o;for(const s of i){if(this.abortController.signal.aborted)throw new Error("下载已取消");try{const n=yield fetch(this.options.modelUrl,{headers:{Range:`bytes=${s.start}-${s.end}`},signal:this.abortController.signal});if(!n.ok&&206!==n.status)throw new Error(`分块下载失败: ${n.status} ${n.statusText}`);const t=yield n.arrayBuffer();yield ae.saveModel(s.chunkId,t),r.set(new Uint8Array(t),s.start),this.loadedChunks++,this.progress=this.loadedChunks/this.totalChunks,e.onProgress&&e.onProgress(this.progress)}catch(n){if("AbortError"===n.name)throw new Error("下载已取消");throw n}}return e.onComplete&&e.onComplete(o),o}catch(n){throw this.error=n,e.onError&&e.onError(n),n}finally{this.isLoading=!1,this.abortController=null}}))}loadModelFromCache(){return d(this,null,(function*(){try{const e=yield this.getModelMetadata();if(!e)throw new Error("模型元数据不存在");const n=new ArrayBuffer(e.totalSize),t=new Uint8Array(n);for(let o=0;o<e.totalChunks;o++){const n=`${this.options.modelId}_chunk_${o}`,r=yield ae.getModel(n);if(!r)throw new Error(`分块 ${o} 不存在`);const i=o*e.chunkSize;t.set(new Uint8Array(r),i)}return n}catch(e){throw e}}))}loadModel(){return d(this,arguments,(function*(e={}){try{if(yield this.isModelFullyCached()){e.onProgress&&e.onProgress(.5);const n=yield this.loadModelFromCache();return e.onProgress&&e.onProgress(1),e.onComplete&&e.onComplete(n),n}return yield this.downloadModelInChunks(e)}catch(n){throw e.onError&&e.onError(n),n}}))}cancelDownload(){this.abortController&&this.abortController.abort()}clearModelCache(){return d(this,null,(function*(){try{const e=yield this.getModelMetadata();if(!e)return!0;for(let n=0;n<e.totalChunks;n++){const e=`${this.options.modelId}_chunk_${n}`;yield ae.deleteModel(e)}return yield ae.deleteModel(this.metadataKey),!0}catch(e){return!1}}))}};class ce{constructor(e={}){this.options=l({modelId:"Qwen/Qwen3.0-0.6B-Chat-GGUF",modelSize:"0.6B",quantization:"q4_0",useWebGPU:!1,useProgressiveLoading:!0},e),this.model=null,this.chat=null,this.isLoading=!1,this.progress=0,this.error=null,this.loadingStage="准备中",this.modelUrl=e.modelUrl||"https://cdn.jsppt.com/models/qwen3-0.6b-q4.gguf",this.options.useProgressiveLoading&&(de.options.modelId=this.options.modelId,de.options.modelUrl=this.modelUrl),this.systemPrompt=e.systemPrompt||'你是一个专业的演示文稿生成助手，擅长创建Marp格式的Markdown演示文稿。\n请根据用户的主题生成一个完整的演示文稿，包含以下内容：\n1. 封面页：包含主题标题\n2. 目录页：列出演示文稿的主要内容\n3. 内容页：每页一个要点，包含简洁的要点列表\n4. 总结页：总结主要观点\n\n遵循以下Marp格式规范:\n1. 文档开头必须包含以下前置元数据:\n   ---\n   marp: true\n   theme: default\n   paginate: true\n   ---\n\n2. 使用"---"分隔不同的幻灯片\n\n3. 幻灯片结构指南:\n   - 第一张幻灯片应为标题页，包含主标题和副标题\n   - 第二张幻灯片通常为目录或概述\n   - 最后一张幻灯片应为总结或联系方式\n\n4. 格式化技巧:\n   - 使用 # 表示一级标题，## 表示二级标题，依此类推\n   - 每张幻灯片内容简洁，通常5-7个要点为宜\n   - 可以使用 ![bg](图片URL) 设置背景图片\n   - 可以使用 ![bg left:40%](图片URL) 创建分栏布局\n\n请直接输出Markdown内容，不要有额外的解释。'}isModelLoaded(){return null!==this.model&&null!==this.chat}getProgress(){return this.progress}getLoadingStage(){return this.loadingStage}loadModel(){return d(this,arguments,(function*(e={}){if(this.isLoading)return!1;try{this.isLoading=!0,this.error=null,this.progress=0,this.loadingStage="准备中",e.onProgress&&e.onProgress(this.progress),this.loadingStage="加载WebLLM库";const t=yield A((()=>import("./index-3abfe8f4.js")),[]);this.loadingStage="初始化模型";try{"function"==typeof t.CreateMLCEngine?this.chat=yield t.CreateMLCEngine(this.options.modelId,{initProgressCallback:e=>{this.progress=e.progress||0,this.loadingStage=e.text||"加载中"},useWebGPU:this.options.useWebGPU}):"function"==typeof t.ChatModule&&/^\s*class\s+/.test(t.ChatModule.toString())?this.chat=new t.ChatModule:"function"==typeof t.createChatModule?this.chat=t.createChatModule():"function"==typeof t.ChatModule?this.chat=t.ChatModule():t.chat?this.chat=t.chat:this.chat=new t.default}catch(n){throw new Error(`创建WebLLM引擎失败: ${n.message}`)}if(this.chat.chat&&this.chat.chat.completions)this.loadingStage="模型已加载";else{const n={wasmUrl:this.options.useWebGPU?void 0:"https://cdn.jsdelivr.net/npm/@mlc-ai/web-llm/lib/",useWebGPU:this.options.useWebGPU};if("function"==typeof this.chat.init&&(yield this.chat.init(n)),this.options.useProgressiveLoading){this.loadingStage="检查模型缓存";const n=yield de.isModelFullyCached();this.loadingStage=n?"从缓存加载模型":"下载模型文件",yield de.loadModel({onProgress:n=>{this.progress=.8*n,this.loadingStage=n<.1?"准备下载":n<.8?"下载模型文件":n<.9?"保存到缓存":"准备加载模型",e.onProgress&&e.onProgress(this.progress)},onError:e=>{throw this.loadingStage="下载失败",e}}),this.loadingStage="加载模型到内存";const t={model_list:[{model_id:this.options.modelId,model_url:this.modelUrl,local_id:this.options.modelId}]};"function"==typeof this.chat.reload&&(yield this.chat.reload(this.options.modelId,t))}else this.loadingStage="下载模型文件","function"==typeof this.chat.setInitProgressCallback&&this.chat.setInitProgressCallback((n=>{const t=n.progress.stage;let o=0;"download"===t?(o=.8*n.progress.progress,this.loadingStage="下载模型文件"):"load"===t&&(o=.8+.2*n.progress.progress,this.loadingStage="加载模型到内存"),this.progress=o,e.onProgress&&e.onProgress(o)})),"function"==typeof this.chat.reload&&(yield this.chat.reload(this.options.modelId,{model_list:[{model_id:this.options.modelId,model_url:this.modelUrl}]}));this.loadingStage="配置模型","function"==typeof this.chat.resetChat&&(yield this.chat.resetChat(this.systemPrompt))}return this.model=this.chat,this.progress=1,this.loadingStage="加载完成",e.onProgress&&e.onProgress(1),e.onSuccess&&e.onSuccess(),!0}catch(n){return this.error=n,this.loadingStage="加载失败",e.onError&&e.onError(n),!1}finally{this.isLoading=!1}}))}generateMarpMarkdown(e){return d(this,arguments,(function*(e,n={}){if(!this.isModelLoaded())throw new Error("模型尚未加载");try{const t=l(l({},{stream:!1,max_tokens:2048,temperature:.7,top_p:.9}),n),o=`请为主题"${e}"创建一个Marp格式的演示文稿。`,r=[{role:"system",content:this.systemPrompt},{role:"user",content:o}];let i="";if(this.chat.chat&&this.chat.chat.completions&&"function"==typeof this.chat.chat.completions.create){i=(yield this.chat.chat.completions.create(l({messages:r},t))).choices[0].message.content}else if("function"==typeof this.chat.generate){i=(yield this.chat.generate(r,t)).text}else{if("function"!=typeof this.chat.getMessage)throw new Error("无法找到有效的生成方法");yield this.chat.resetChat();for(const e of r)yield this.chat.generate(e.content);i=yield this.chat.getMessage()}return i.startsWith("---\nmarp: true")||(i=`---\nmarp: true\ntheme: default\npaginate: true\n---\n\n${i}`),i}catch(t){throw t}}))}unloadModel(){return d(this,null,(function*(){if(this.chat)try{"function"==typeof this.chat.unload?yield this.chat.unload():"function"==typeof this.chat.dispose&&(yield this.chat.dispose()),this.model=null,this.chat=null}catch(e){}}))}clearModelCache(){return d(this,null,(function*(){return!this.options.useProgressiveLoading||(yield de.clearModelCache())}))}}new ce;class he{constructor(e){this.device=e,this.model=null,this.isLoading=!1,this.progress=0,this.error=null,this.modelId="qwen3-0.6b",this.modelUrl="https://cdn.jsppt.com/models/qwen3-0.6b-q4.gguf"}isModelLoaded(){return null!==this.model}getProgress(){return this.progress}loadModel(){return d(this,arguments,(function*(e={}){if(this.isLoading)return!1;try{this.isLoading=!0,this.error=null;const n=yield ae.hasModel(this.modelId);if(this.progress=0,e.onProgress&&e.onProgress(this.progress),n)for(let t=0;t<3;t++)yield new Promise((e=>setTimeout(e,300))),this.progress=(t+1)/3,e.onProgress&&e.onProgress(this.progress);else{for(let n=0;n<10;n++)yield new Promise((e=>setTimeout(e,500))),this.progress=(n+1)/10,e.onProgress&&e.onProgress(this.progress);yield ae.saveModel(this.modelId,{timestamp:Date.now()})}return this.model={generate:e=>d(this,null,(function*(){return yield new Promise((e=>setTimeout(e,2e3))),{text:this.generateDummyMarkdown(e)}}))},e.onSuccess&&e.onSuccess(),!0}catch(n){return this.error=n,e.onError&&e.onError(n),!1}finally{this.isLoading=!1}}))}generateMarpMarkdown(e){return d(this,null,(function*(){if(!this.isModelLoaded())throw new Error("模型尚未加载");try{return(yield this.model.generate(e)).text}catch(n){throw n}}))}unloadModel(){return d(this,null,(function*(){if(this.model)try{yield new Promise((e=>setTimeout(e,500))),this.model=null}catch(e){}}))}generateDummyMarkdown(e){return`---\nmarp: true\ntheme: default\npaginate: true\n---\n\n# ${e}\n\n---\n\n## 目录\n\n1. 引言\n2. 主要内容\n3. 案例分析\n4. 总结与展望\n\n---\n\n## 引言\n\n- ${e}是当今热门话题\n- 具有广泛的应用前景\n- 正在快速发展和演变\n\n---\n\n## 主要内容\n\n- 核心概念和原理\n- 技术架构和实现方式\n- 优势与局限性\n- 最新研究进展\n\n---\n\n## 案例分析\n\n- 案例1：行业应用示例\n- 案例2：创新实践\n- 案例3：未来展望\n\n---\n\n## 总结与展望\n\n- ${e}的重要性日益凸显\n- 未来发展趋势\n- 潜在机会与挑战\n\n---\n\n# 谢谢观看！\n\n联系方式：example@jsppt.com`}}class ue{constructor(e,n){this.context=e,this.version=n,this.model=null,this.isLoading=!1,this.progress=0,this.error=null,this.modelId="qwen3-0.6b",this.modelUrl="https://cdn.jsppt.com/models/qwen3-0.6b-q4.gguf"}isModelLoaded(){return null!==this.model}getProgress(){return this.progress}loadModel(){return d(this,arguments,(function*(e={}){if(this.isLoading)return!1;try{this.isLoading=!0,this.error=null;const n=yield ae.hasModel(this.modelId);if(this.progress=0,e.onProgress&&e.onProgress(this.progress),n)for(let t=0;t<4;t++)yield new Promise((e=>setTimeout(e,400))),this.progress=(t+1)/4,e.onProgress&&e.onProgress(this.progress);else{for(let n=0;n<10;n++)yield new Promise((e=>setTimeout(e,600))),this.progress=(n+1)/10,e.onProgress&&e.onProgress(this.progress);yield ae.saveModel(this.modelId,{timestamp:Date.now()})}return this.model={generate:e=>d(this,null,(function*(){return yield new Promise((e=>setTimeout(e,3e3))),{text:this.generateDummyMarkdown(e)}}))},e.onSuccess&&e.onSuccess(),!0}catch(n){return this.error=n,e.onError&&e.onError(n),!1}finally{this.isLoading=!1}}))}generateMarpMarkdown(e){return d(this,null,(function*(){if(!this.isModelLoaded())throw new Error("模型尚未加载");try{return(yield this.model.generate(e)).text}catch(n){throw n}}))}unloadModel(){return d(this,null,(function*(){if(this.model)try{yield new Promise((e=>setTimeout(e,500))),this.model=null}catch(e){}}))}generateDummyMarkdown(e){return`---\nmarp: true\ntheme: default\npaginate: true\n---\n\n# ${e}\n\n---\n\n## 目录\n\n1. 引言\n2. 主要内容\n3. 案例分析\n4. 总结与展望\n\n---\n\n## 引言\n\n- ${e}是当今热门话题\n- 具有广泛的应用前景\n- 正在快速发展和演变\n\n---\n\n## 主要内容\n\n- 核心概念和原理\n- 技术架构和实现方式\n- 优势与局限性\n- 最新研究进展\n\n---\n\n## 案例分析\n\n- 案例1：行业应用示例\n- 案例2：创新实践\n- 案例3：未来展望\n\n---\n\n## 总结与展望\n\n- ${e}的重要性日益凸显\n- 未来发展趋势\n- 潜在机会与挑战\n\n---\n\n# 谢谢观看！\n\n联系方式：example@jsppt.com`}}class me{constructor(){this.model=null,this.isLoading=!1,this.progress=0,this.error=null,this.modelId="qwen3-0.6b",this.modelUrl="https://cdn.jsppt.com/models/qwen3-0.6b-q4.gguf"}isModelLoaded(){return null!==this.model}getProgress(){return this.progress}loadModel(){return d(this,arguments,(function*(e={}){if(this.isLoading)return!1;try{this.isLoading=!0,this.error=null;const n=yield ae.hasModel(this.modelId);if(this.progress=0,e.onProgress&&e.onProgress(this.progress),n)for(let t=0;t<5;t++)yield new Promise((e=>setTimeout(e,500))),this.progress=(t+1)/5,e.onProgress&&e.onProgress(this.progress);else{for(let n=0;n<10;n++)yield new Promise((e=>setTimeout(e,700))),this.progress=(n+1)/10,e.onProgress&&e.onProgress(this.progress);yield ae.saveModel(this.modelId,{timestamp:Date.now()})}return this.model={generate:e=>d(this,null,(function*(){return yield new Promise((e=>setTimeout(e,4e3))),{text:this.generateDummyMarkdown(e)}}))},e.onSuccess&&e.onSuccess(),!0}catch(n){return this.error=n,e.onError&&e.onError(n),!1}finally{this.isLoading=!1}}))}generateMarpMarkdown(e){return d(this,null,(function*(){if(!this.isModelLoaded())throw new Error("模型尚未加载");try{return(yield this.model.generate(e)).text}catch(n){throw n}}))}unloadModel(){return d(this,null,(function*(){if(this.model)try{yield new Promise((e=>setTimeout(e,500))),this.model=null}catch(e){}}))}generateDummyMarkdown(e){return`---\nmarp: true\ntheme: default\npaginate: true\n---\n\n# ${e}\n\n---\n\n## 目录\n\n1. 引言\n2. 主要内容\n3. 案例分析\n4. 总结与展望\n\n---\n\n## 引言\n\n- ${e}是当今热门话题\n- 具有广泛的应用前景\n- 正在快速发展和演变\n\n---\n\n## 主要内容\n\n- 核心概念和原理\n- 技术架构和实现方式\n- 优势与局限性\n- 最新研究进展\n\n---\n\n## 案例分析\n\n- 案例1：行业应用示例\n- 案例2：创新实践\n- 案例3：未来展望\n\n---\n\n## 总结与展望\n\n- ${e}的重要性日益凸显\n- 未来发展趋势\n- 潜在机会与挑战\n\n---\n\n# 谢谢观看！\n\n联系方式：example@jsppt.com`}}class pe{constructor(){this.model=null,this.isLoading=!1,this.progress=0,this.error=null,this.apiEndpoint="https://api.jsppt.com/generate"}isModelLoaded(){return null!==this.model}getProgress(){return this.progress}loadModel(){return d(this,arguments,(function*(e={}){if(this.isLoading)return!1;try{this.isLoading=!0,this.error=null,this.progress=0,e.onProgress&&e.onProgress(this.progress);for(let n=0;n<3;n++)yield new Promise((e=>setTimeout(e,500))),this.progress=(n+1)/3,e.onProgress&&e.onProgress(this.progress);return this.model={generate:e=>d(this,null,(function*(){return yield new Promise((e=>setTimeout(e,2e3))),{text:this.generateDummyMarkdown(e)}}))},e.onSuccess&&e.onSuccess(),!0}catch(n){return this.error=n,e.onError&&e.onError(n),!1}finally{this.isLoading=!1}}))}generateMarpMarkdown(e){return d(this,null,(function*(){if(!this.isModelLoaded())throw new Error("API客户端尚未初始化");try{return(yield this.model.generate(e)).text}catch(n){throw n}}))}unloadModel(){return d(this,null,(function*(){if(this.model)try{yield new Promise((e=>setTimeout(e,200))),this.model=null}catch(e){}}))}generateDummyMarkdown(e){return`---\nmarp: true\ntheme: default\npaginate: true\n---\n\n# ${e}\n\n---\n\n## 目录\n\n1. 引言\n2. 主要内容\n3. 案例分析\n4. 总结与展望\n\n---\n\n## 引言\n\n- ${e}是当今热门话题\n- 具有广泛的应用前景\n- 正在快速发展和演变\n\n---\n\n## 主要内容\n\n- 核心概念和原理\n- 技术架构和实现方式\n- 优势与局限性\n- 最新研究进展\n\n---\n\n## 案例分析\n\n- 案例1：行业应用示例\n- 案例2：创新实践\n- 案例3：未来展望\n\n---\n\n## 总结与展望\n\n- ${e}的重要性日益凸显\n- 未来发展趋势\n- 潜在机会与挑战\n\n---\n\n# 谢谢观看！\n\n联系方式：example@jsppt.com`}}const ge=new class{createModelService(){return d(this,arguments,(function*(e={}){const n=yield le.getFullCompatibilityReport();if(e.forceService)switch(e.forceService){case"webllm":return new ce(e);case"webgpu":return new he(e);case"webgl":return new ue(e);case"wasm":return new me(e);case"remote":return new pe(e)}return n.webgpu.supported?new ce(a(l({},e),{useWebGPU:!0})):n.webgl.supported?new ce(a(l({},e),{useWebGPU:!1})):"low"!==n.performance.performanceTier?new me(e):(n.isMobile||n.performance.performanceTier,new pe(e))}))}getModelServiceOptions(){return[{id:"auto",name:"自动选择最佳方式"},{id:"webllm",name:"WebLLM（浏览器本地运行）"},{id:"webgpu",name:"WebGPU加速（高性能）"},{id:"webgl",name:"WebGL加速（兼容性好）"},{id:"wasm",name:"WASM CPU执行（通用）"},{id:"remote",name:"远程API（低性能设备）"}]}},fe={class:"app-container"},be={class:"app-header"},ye={class:"container header-content"},we={key:0,class:"header-actions"},ve={class:"app-main"},xe={key:0,class:"model-loading container"},ke={class:"loading-card"},Pe={class:"progress-section"},Me={class:"progress-status"},Ce={class:"progress-bar"},Se=["disabled"],Te={class:"compatibility-info"},Ee={class:"status-icon"},Le={class:"status-details"},$e={key:0},Fe={key:1},Ie={class:"advanced-options"},ze={class:"options-content"},Ue={class:"option-group"},De=["value"],Ae={key:1,class:"editor-container container"},je={class:"editor-header"},_e={class:"theme-selector"},qe=["value"],Oe={class:"editor-content"},We={class:"input-section"},Ge={class:"section-header"},Be={class:"input-actions"},Ne=["disabled"],He=["disabled"],Xe={class:"generation-options"},Re={class:"option-group"},Ve={class:"option-group"},Ke=["disabled"],Ye={key:0},Qe={key:1},Je={key:0,class:"output-section"},Ze={class:"section-header"},en={class:"output-info"},nn={class:"slide-count-badge"},tn={class:"markdown-preview"},on={class:"actions"},rn={key:1,class:"empty-output"},sn={class:"empty-state"},ln={class:"example-prompts"},an=["onClick"],dn={class:"modal-container"},cn={class:"modal-header"},hn={class:"modal-content"},un={class:"settings-section"},mn={class:"setting-group"},pn=["value"],gn={class:"settings-section"},fn={class:"setting-group"},bn=["value"],yn={class:"modal-footer"},wn={class:"modal-container"},vn={class:"modal-header"},xn={class:"modal-footer"},kn={class:"app-footer"},Pn={class:"container"};const Mn=D(B({components:{MarpPreview:se},setup(){const e=c(!1),n=c(!1),t=c(0),o=c("准备中"),r=c(""),i=c(""),s=c(!1),l=c(!1),a=c(!1),g=c(!1),f=c(!1),b=c(null),y=c("wasm"),w=c("default"),v=c("auto"),x=c("professional"),k=c(0),P=c(G()),M=c(ge.getModelServiceOptions()),C=c({supported:!1,accelerationMethod:"",reason:"正在检测兼容性..."}),S=h((()=>`${Math.round(100*t.value)}%`));u(y,(n=>{e.value&&alert("执行模式已更改，需要重新加载模型才能生效。")})),u(i,(e=>{if(e){const n=(e.match(/\n---\n/g)||[]).length;k.value=n+1}else k.value=0}));const T=()=>d(this,null,(function*(){try{const e=yield le.getFullCompatibilityReport();if(e.webgpu.supported)return void(C.value={supported:!0,accelerationMethod:"WebGPU",reason:""});if(e.webgl.supported)return void(C.value={supported:!0,accelerationMethod:"WebGL",reason:""});if("low"!==e.performance.performanceTier)return void(C.value={supported:!0,accelerationMethod:"WASM",reason:""});C.value={supported:!1,accelerationMethod:"",reason:"您的设备性能可能不足以流畅运行AI模型。建议使用最新版Chrome或Edge浏览器，或使用性能更好的设备。"}}catch(e){C.value={supported:!1,accelerationMethod:"",reason:"兼容性检测失败，建议使用最新版Chrome或Edge浏览器。"}}})),E=()=>d(this,null,(function*(){if(r.value&&!s.value){s.value=!0;try{let e=r.value;if("auto"!==v.value&&(e+=`\n请生成${v.value}张幻灯片。`),"professional"!==x.value){e+=`\n风格要求：${{academic:"学术",creative:"创意",minimal:"简约"}[x.value]}。`}const n=yield b.value.generateMarpMarkdown(e);if(n.includes("theme:"))i.value=n.replace(/theme:.*\n/,`theme: ${w.value}\n`);else{const e=n.indexOf("---\n\n");i.value=e>0?n.slice(0,e)+`theme: ${w.value}\n`+n.slice(e):n}}catch(e){alert(`生成失败: ${e.message}`)}finally{s.value=!1}}})),L=e=>{e.ctrlKey&&"Enter"===e.key&&!s.value&&r.value&&E(),"Escape"===e.key&&(l.value&&(l.value=!1),a.value&&(a.value=!1),g.value&&(g.value=!1))};return m((()=>{T(),window.addEventListener("keydown",L)})),p((()=>{b.value&&b.value.unloadModel(),window.removeEventListener("keydown",L)})),{modelLoaded:e,isLoading:n,progress:t,loadingStage:o,prompt:r,markdown:i,isGenerating:s,showPreview:l,showSettings:a,showHelp:g,isEditingMarkdown:f,executionMode:y,selectedTheme:w,slideCount:v,presentationStyle:x,generatedSlideCount:k,availableThemes:P,modelServiceOptions:M,compatibilityInfo:C,examplePrompts:["人工智能在医疗领域的应用与未来发展","可持续发展与环保科技创新","数字化转型对企业的影响","太空探索的历史与未来展望","现代教育技术与学习方式变革"],progressText:S,loadModel:()=>d(this,null,(function*(){if(!n.value){n.value=!0,t.value=0,o.value="准备中";try{const n={forceService:"auto"===y.value?null:y.value};o.value="初始化模型服务",b.value=yield ge.createModelService(n),yield b.value.loadModel({onProgress:e=>{t.value=e,b.value.getLoadingStage?o.value=b.value.getLoadingStage():o.value=e<.1?"准备下载":e<.8?"下载模型文件":e<.9?"加载模型到内存":"初始化模型"},onSuccess:()=>{e.value=!0,o.value="加载完成"},onError:e=>{alert(`模型加载失败: ${e.message}`),o.value="加载失败"}})}catch(r){alert(`模型加载失败: ${r.message}`),o.value="加载失败"}finally{n.value=!1}}})),generatePresentation:E,clearPrompt:()=>{r.value=""},insertTemplate:()=>{r.value="请为我创建一个关于[主题]的演示文稿，目标受众是[受众]，风格要求[风格]。"},useExamplePrompt:e=>{r.value=e},editMarkdown:()=>{f.value=!0,alert("Markdown编辑功能即将推出，敬请期待！")},previewPresentation:()=>{l.value=!0},updateTheme:e=>{w.value=e},handleExport:e=>{},exportPDF:()=>d(this,null,(function*(){try{yield O(i.value,"presentation.pdf",w.value)}catch(e){alert(`PDF导出失败: ${e.message}`)}})),exportPPTX:()=>d(this,null,(function*(){try{yield W(i.value,"presentation.pptx",w.value)}catch(e){alert(`PPTX导出失败: ${e.message}`)}}))}}},[["render",function(e,n,t,o,r,i){const s=L("MarpPreview");return g(),f("div",fe,[b("header",be,[b("div",ye,[n[26]||(n[26]=b("div",{class:"logo-section"},[b("h1",{class:"app-title"},"jsPPT"),b("div",{class:"app-subtitle"},"AI演示文稿生成器")],-1)),o.modelLoaded?(g(),f("div",we,[b("button",{onClick:n[0]||(n[0]=e=>o.showSettings=!0),class:"btn btn-sm btn-outline"},n[24]||(n[24]=[b("span",{class:"icon"},"⚙️",-1),M(" 设置 ")])),b("button",{onClick:n[1]||(n[1]=e=>o.showHelp=!0),class:"btn btn-sm btn-outline"},n[25]||(n[25]=[b("span",{class:"icon"},"❓",-1),M(" 帮助 ")]))])):w("",!0)])]),b("main",ve,[o.modelLoaded?(g(),f("div",Ae,[b("div",je,[n[32]||(n[32]=b("h2",null,"创建演示文稿",-1)),b("div",_e,[n[31]||(n[31]=b("label",{for:"theme-select"},"主题:",-1)),v(b("select",{id:"theme-select","onUpdate:modelValue":n[4]||(n[4]=e=>o.selectedTheme=e),class:"select-input"},[(g(!0),f(k,null,P(o.availableThemes,(e=>(g(),f("option",{key:e.id,value:e.id},y(e.name),9,qe)))),128))],512),[[x,o.selectedTheme]])])]),b("div",Oe,[b("div",We,[b("div",Ge,[n[35]||(n[35]=b("h3",null,"输入您的演示文稿主题",-1)),b("div",Be,[b("button",{onClick:n[5]||(n[5]=(...e)=>o.clearPrompt&&o.clearPrompt(...e)),class:"btn btn-sm btn-text",disabled:!o.prompt},n[33]||(n[33]=[b("span",{class:"icon"},"🗑️",-1),M(" 清空 ")]),8,Ne),b("button",{onClick:n[6]||(n[6]=(...e)=>o.insertTemplate&&o.insertTemplate(...e)),class:"btn btn-sm btn-text"},n[34]||(n[34]=[b("span",{class:"icon"},"📋",-1),M(" 模板 ")]))])]),v(b("textarea",{"onUpdate:modelValue":n[7]||(n[7]=e=>o.prompt=e),placeholder:"例如：人工智能在医疗领域的应用与未来发展",rows:"5",class:"prompt-input",disabled:o.isGenerating},null,8,He),[[z,o.prompt]]),b("div",Xe,[b("div",Re,[n[37]||(n[37]=b("label",{for:"slide-count"},"幻灯片数量:",-1)),v(b("select",{id:"slide-count","onUpdate:modelValue":n[8]||(n[8]=e=>o.slideCount=e),class:"select-input"},n[36]||(n[36]=[$('<option value="auto">自动</option><option value="5">5张</option><option value="10">10张</option><option value="15">15张</option><option value="20">20张</option>',5)]),512),[[x,o.slideCount]])]),b("div",Ve,[n[39]||(n[39]=b("label",{for:"style"},"风格:",-1)),v(b("select",{id:"style","onUpdate:modelValue":n[9]||(n[9]=e=>o.presentationStyle=e),class:"select-input"},n[38]||(n[38]=[b("option",{value:"professional"},"专业",-1),b("option",{value:"academic"},"学术",-1),b("option",{value:"creative"},"创意",-1),b("option",{value:"minimal"},"简约",-1)]),512),[[x,o.presentationStyle]])])]),b("button",{onClick:n[10]||(n[10]=(...e)=>o.generatePresentation&&o.generatePresentation(...e)),disabled:o.isGenerating||!o.prompt,class:"btn btn-primary generate-btn"},[o.isGenerating?(g(),f("span",Ye,n[40]||(n[40]=[b("span",{class:"loading-spinner"},null,-1),M(" 生成中... ")]))):(g(),f("span",Qe,"生成演示文稿"))],8,Ke)]),o.markdown?(g(),f("div",Je,[b("div",Ze,[n[41]||(n[41]=b("h3",null,"生成的演示文稿",-1)),b("div",en,[b("span",nn,y(o.generatedSlideCount)+"张幻灯片",1)])]),b("div",tn,[b("pre",null,y(o.markdown),1)]),b("div",on,[b("button",{onClick:n[11]||(n[11]=(...e)=>o.editMarkdown&&o.editMarkdown(...e)),class:"btn btn-secondary"},n[42]||(n[42]=[b("span",{class:"icon"},"✏️",-1),M(" 编辑 ")])),b("button",{onClick:n[12]||(n[12]=(...e)=>o.previewPresentation&&o.previewPresentation(...e)),class:"btn btn-primary"},n[43]||(n[43]=[b("span",{class:"icon"},"👁️",-1),M(" 预览 ")])),b("button",{onClick:n[13]||(n[13]=(...e)=>o.exportPDF&&o.exportPDF(...e)),class:"btn btn-secondary"},n[44]||(n[44]=[b("span",{class:"icon"},"📄",-1),M(" PDF ")])),b("button",{onClick:n[14]||(n[14]=(...e)=>o.exportPPTX&&o.exportPPTX(...e)),class:"btn btn-secondary"},n[45]||(n[45]=[b("span",{class:"icon"},"📊",-1),M(" PPTX ")]))])])):o.modelLoaded&&!o.isGenerating?(g(),f("div",rn,[b("div",sn,[n[47]||(n[47]=b("div",{class:"empty-icon"},"🎬",-1)),n[48]||(n[48]=b("h3",null,"准备好创建演示文稿了吗？",-1)),n[49]||(n[49]=b("p",null,"输入您的主题，AI将为您生成一个完整的演示文稿。",-1)),b("div",ln,[n[46]||(n[46]=b("p",null,"示例主题:",-1)),(g(!0),f(k,null,P(o.examplePrompts,((e,n)=>(g(),f("button",{key:n,onClick:n=>o.useExamplePrompt(e),class:"example-btn"},y(e),9,an)))),128))])])])):w("",!0)])])):(g(),f("div",xe,[b("div",ke,[n[30]||(n[30]=$('<h2>准备AI模型</h2><div class="model-info"><div class="model-icon">🤖</div><div class="model-details"><p class="model-name">Qwen 3.0-0.6B</p><p class="model-description">轻量级AI模型，适合在浏览器中运行</p></div></div>',2)),b("div",Pe,[b("div",Me,[b("span",null,y(o.loadingStage),1),b("span",null,y(o.progressText),1)]),b("div",Ce,[b("div",{class:"progress",style:F({width:100*o.progress+"%"})},null,4)])]),b("button",{onClick:n[2]||(n[2]=(...e)=>o.loadModel&&o.loadModel(...e)),disabled:o.isLoading,class:"btn btn-primary load-btn"},y(o.isLoading?"加载中...":"开始加载"),9,Se),b("div",Te,[n[29]||(n[29]=b("h3",null,"浏览器兼容性",-1)),b("div",{class:I(["compatibility-status",{"status-ok":o.compatibilityInfo.supported,"status-warning":!o.compatibilityInfo.supported}])},[b("span",Ee,y(o.compatibilityInfo.supported?"✅":"⚠️"),1),b("div",Le,[o.compatibilityInfo.supported?(g(),f("p",$e," 您的浏览器支持 "+y(o.compatibilityInfo.accelerationMethod)+"，可以获得最佳体验。 ",1)):(g(),f("p",Fe," 您的浏览器可能不支持最佳的AI加速方式。"+y(o.compatibilityInfo.reason),1))])],2),b("div",Ie,[b("details",null,[n[28]||(n[28]=b("summary",null,"高级选项",-1)),b("div",ze,[b("div",Ue,[n[27]||(n[27]=b("label",{for:"execution-mode"},"执行模式:",-1)),v(b("select",{id:"execution-mode","onUpdate:modelValue":n[3]||(n[3]=e=>o.executionMode=e),class:"select-input"},[(g(!0),f(k,null,P(o.modelServiceOptions,(e=>(g(),f("option",{key:e.id,value:e.id},y(e.name),9,De)))),128))],512),[[x,o.executionMode]])])])])])])])]))]),o.showPreview?(g(),U(s,{key:0,markdown:o.markdown,initialTheme:o.selectedTheme,onClose:n[15]||(n[15]=e=>o.showPreview=!1),onThemeChange:o.updateTheme,onExport:o.handleExport},null,8,["markdown","initialTheme","onThemeChange","onExport"])):w("",!0),o.showSettings?(g(),f("div",{key:1,class:"modal-overlay",onClick:n[20]||(n[20]=E((e=>o.showSettings=!1),["self"]))},[b("div",dn,[b("div",cn,[n[50]||(n[50]=b("h2",null,"设置",-1)),b("button",{class:"close-btn",onClick:n[16]||(n[16]=e=>o.showSettings=!1)},"×")]),b("div",hn,[b("div",un,[n[52]||(n[52]=b("h3",null,"模型设置",-1)),b("div",mn,[n[51]||(n[51]=b("label",{for:"model-service"},"执行模式:",-1)),v(b("select",{id:"model-service","onUpdate:modelValue":n[17]||(n[17]=e=>o.executionMode=e),class:"select-input"},[(g(!0),f(k,null,P(o.modelServiceOptions,(e=>(g(),f("option",{key:e.id,value:e.id},y(e.name),9,pn)))),128))],512),[[x,o.executionMode]])]),n[53]||(n[53]=b("p",{class:"setting-description"}," 选择模型的执行方式。自动模式会根据您的浏览器和设备性能选择最佳方式。 ",-1))]),b("div",gn,[n[55]||(n[55]=b("h3",null,"外观设置",-1)),b("div",fn,[n[54]||(n[54]=b("label",{for:"default-theme"},"默认主题:",-1)),v(b("select",{id:"default-theme","onUpdate:modelValue":n[18]||(n[18]=e=>o.selectedTheme=e),class:"select-input"},[(g(!0),f(k,null,P(o.availableThemes,(e=>(g(),f("option",{key:e.id,value:e.id},y(e.name),9,bn)))),128))],512),[[x,o.selectedTheme]])])]),n[56]||(n[56]=b("div",{class:"settings-section"},[b("h3",null,"关于"),b("p",null,"jsPPT 版本: 1.0.0"),b("p",null,"使用 Vue.js 和 Marp 构建"),b("p",null,"模型: Qwen 3.0-0.6B")],-1))]),b("div",yn,[b("button",{onClick:n[19]||(n[19]=e=>o.showSettings=!1),class:"btn btn-primary"},"确定")])])])):w("",!0),o.showHelp?(g(),f("div",{key:2,class:"modal-overlay",onClick:n[23]||(n[23]=E((e=>o.showHelp=!1),["self"]))},[b("div",wn,[b("div",vn,[n[57]||(n[57]=b("h2",null,"使用帮助",-1)),b("button",{class:"close-btn",onClick:n[21]||(n[21]=e=>o.showHelp=!1)},"×")]),n[58]||(n[58]=$('<div class="modal-content"><div class="help-section"><h3>快速开始</h3><ol class="help-steps"><li>在输入框中输入您的演示文稿主题</li><li>点击&quot;生成演示文稿&quot;按钮</li><li>等待AI生成内容</li><li>使用&quot;预览&quot;按钮查看效果</li><li>使用&quot;PDF&quot;或&quot;PPTX&quot;按钮导出</li></ol></div><div class="help-section"><h3>提示技巧</h3><ul class="help-tips"><li>使用具体、明确的主题描述获得更好的结果</li><li>可以指定目标受众，如&quot;面向高中生的太阳系介绍&quot;</li><li>可以指定风格，如&quot;简约风格的项目计划演示&quot;</li><li>生成后可以编辑Markdown内容进行自定义</li></ul></div><div class="help-section"><h3>键盘快捷键</h3><div class="shortcut-list"><div class="shortcut-item"><span class="shortcut-key">Ctrl+Enter</span><span class="shortcut-desc">生成演示文稿</span></div><div class="shortcut-item"><span class="shortcut-key">Esc</span><span class="shortcut-desc">关闭预览</span></div><div class="shortcut-item"><span class="shortcut-key">←/→</span><span class="shortcut-desc">预览中切换幻灯片</span></div></div></div></div>',1)),b("div",xn,[b("button",{onClick:n[22]||(n[22]=e=>o.showHelp=!1),class:"btn btn-primary"},"了解了")])])])):w("",!0),b("footer",kn,[b("div",Pn,[b("p",null,"© "+y((new Date).getFullYear())+" jsPPT - 基于Web技术的AI演示文稿生成器",1)])])])}]]));Mn.config.errorHandler=(e,n,t)=>{},Mn.mount("#app");
//# sourceMappingURL=index-e55c9349.js.map
